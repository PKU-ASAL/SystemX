# =============================================================================
# SysArmor EDR 极简环境配置 - 12-Factor App模式
# 按服务逻辑分类，只设置核心HOST和端口，其他配置自动派生
# =============================================================================

# 部署模式
DEPLOYMENT_MODE=single-node          # single-node, distributed
ENVIRONMENT=development              # development, production

# =============================================================================
# Manager服务配置 (控制平面)
# =============================================================================
MANAGER_HOST=localhost
MANAGER_PORT=8080

# 数据库配置
POSTGRES_DB=sysarmor
POSTGRES_USER=sysarmor
POSTGRES_PASSWORD=password

# =============================================================================
# Middleware服务配置 (数据中间件)
# =============================================================================
MIDDLEWARE_HOST=localhost            # 分布式部署时设置为远程IP

# 核心端口
VECTOR_TCP_PORT=6000
VECTOR_API_PORT=8686
VECTOR_METRICS_PORT=9598
KAFKA_PORT=9094
PROMETHEUS_PORT=9090

# =============================================================================
# Kafka外部访问配置 (分布式部署专用)
# =============================================================================
# 确保外部客户端能正确连接到Kafka
# 分布式部署时，设置为实际的外部访问地址
KAFKA_EXTERNAL_HOST=${MIDDLEWARE_HOST}
KAFKA_EXTERNAL_PORT=${KAFKA_PORT}

# =============================================================================
# Processor服务配置 (数据处理)
# =============================================================================
PROCESSOR_HOST=localhost
FLINK_PORT=8081

# =============================================================================
# Indexer服务配置 (索引存储)
# =============================================================================
INDEXER_HOST=localhost
OPENSEARCH_PORT=9200

# OpenSearch认证
OPENSEARCH_USERNAME=admin
OPENSEARCH_PASSWORD=admin
INDEX_PREFIX=sysarmor-events

# =============================================================================
# 网络和Volume配置 (基础设施)
# =============================================================================
SYSARMOR_NETWORK=sysarmor-net
SYSARMOR_NETWORK_EXTERNAL=false

# =============================================================================
# Wazuh集成配置 (可选功能)
# =============================================================================
WAZUH_ENABLED=false
WAZUH_MANAGER_HOST=wazuh-manager
WAZUH_MANAGER_PORT=55000
WAZUH_MANAGER_USERNAME=wazuh
WAZUH_MANAGER_PASSWORD=wazuh
WAZUH_INDEXER_HOST=wazuh-indexer
WAZUH_INDEXER_PORT=9200
WAZUH_INDEXER_USERNAME=admin
WAZUH_INDEXER_PASSWORD=admin

# =============================================================================
# 配置说明 - 自动派生的连接配置
# =============================================================================
# Manager服务会自动获得以下配置:
# KAFKA_BOOTSTRAP_SERVERS=${MIDDLEWARE_HOST}:${KAFKA_PORT}
# PROMETHEUS_URL=http://${MIDDLEWARE_HOST}:${PROMETHEUS_PORT}
# OPENSEARCH_URL=http://${INDEXER_HOST}:${OPENSEARCH_PORT}
# FLINK_JOBMANAGER_URL=http://${PROCESSOR_HOST}:${FLINK_PORT}
# WORKER_URLS=${MIDDLEWARE_HOST}:http://${MIDDLEWARE_HOST}:${VECTOR_TCP_PORT}:http://${MIDDLEWARE_HOST}:8686/health
#
# Processor服务会自动获得以下配置:
# KAFKA_BOOTSTRAP_SERVERS=${MIDDLEWARE_HOST}:${KAFKA_PORT}
# OPENSEARCH_URL=http://${INDEXER_HOST}:${OPENSEARCH_PORT}
#
# 部署示例:
# 单机部署: 所有HOST设为localhost
# 分布式部署: MIDDLEWARE_HOST=远程IP，其他HOST=localhost
# 完全分布式: 每个HOST设为对应的服务器IP
